train_type:
  vit_cls: true
  jepa_cls: true
data:
  batch_size: 64
  color_jitter_strength: 0.0
  crop_scale:
  - 0.1
  - 1.0
  crop_size: 224
  image_folder: imagenet-1k-class/
  num_workers: 8
  pin_mem: true
  root_path: dataset/
  use_color_distortion: false
  use_gaussian_blur: false
  use_horizontal_flip: false
logging:
  folder: logs/in-1k_vitc-h16_ep50-v3/
  write_tag: jepa
mask:
  allow_overlap: false
  aspect_ratio:
  - 0.75
  - 1.5
  enc_mask_scale:
  - 0.85
  - 1.0
  min_keep: 10
  num_enc_masks: 1
  num_pred_masks: 4
  patch_size: 16  # if use ConvEmbed will follow Conv kerenel & strides {e.g. [2,2,2,1,1] => patch_size:8}
  pred_mask_scale:
  - 0.15
  - 0.2
meta:
  copy_data: false
  load_checkpoint: false
  model_name: vitc_huge
  conv_channels:
  - 32
  - 32
  - 32
  - 32
  - 32
  - 64 
  - 64
  - 64 
  - 64
  - 64
  - 128
  - 128
  - 128
  - 128
  - 128
  - 256
  - 256
  - 256
  - 256
  - 256
  - 512
  - 512
  - 512
  - 512
  - 512
  - 1024
  - 1024
  - 1024
  - 1024
  # - emb_dim

  conv_strides:
  - 1 # - 32
  - 1 # - 32
  - 1 # - 32
  - 1 # - 32
  - 1 # - 32
  - 1 # - 64 
  - 1 # - 64
  - 1 # - 64 
  - 1 # - 64
  - 2 # - 64
  - 1 # - 128
  - 1 # - 128
  - 1 # - 128
  - 1 # - 128
  - 2 # - 128
  - 1 # - 256
  - 1 # - 256
  - 1 # - 256
  - 1 # - 256
  - 2 # - 256
  - 1 # - 512
  - 1 # - 512
  - 1 # - 512
  - 1 # - 512
  - 2 # - 512
  - 1 # - 1024
  - 1 # - 1024
  - 1 # - 1024
  - 1 # - 1024
  - 1 # # - emb_dim
  pred_depth: 12
  pred_emb_dim: 384
  read_checkpoint: null
  use_bfloat16: true
optimization:
  ema:
  - 0.996
  - 1.0
  epochs: 50
  final_lr: 1.0e-06
  final_weight_decay: 0.4
  ipe_scale: 1.0
  lr: 0.001
  start_lr: 0.0002
  warmup: 40
  weight_decay: 0.04
